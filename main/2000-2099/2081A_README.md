# CF2081A Math Division 题解

从位运算的角度看，下取整就是右移一位，上取整就是先加一再右移一位。
最终要得到 1。
加一会导致进位。
如果最高位 s[0] 没有发生进位，那么右移次数是 n-1。
如果最高位 s[0] 发生进位，那么右移次数是 n。
因此，转化成计算最高位发生进位的概率 P，那么答案为 n-1+P。

从右往左算。下标从 n-1 到 0。
定义 f[i] 表示 s[i] 发生进位的概率。
如果 s[i] = 0，那么 s[i+1] 必须进位且 s[i] 选择上取整，才能让 s[i] 进位，得 f[i] = f[i+1] * (1/2)。
如果 s[i] = 1，那么若 s[i+1] 进位，则 s[i] 一定进位；或者 s[i+1] 没有进位且 s[i] 选择上取整，从而让 s[i] 进位，得 f[i] = f[i+1] + (1-f[i+1]) * (1/2) = (f[i+1]+1) * (1/2)。
二者整合为：f[i] = (f[i+1] + int(s[i])) * (1/2)

初始 f[n] = 0。
计算到 f[1] 为止。
如果 s[1] 进位，那么 s[0] 一定会进位。（s[0] 一定是 1）
如果 s[1] 没有进位，那么 s[0] 不会进位。注意我们不会在 s[0] 做上取整，因为此时已经是 1 了。
所以 P = f[1]。

https://codeforces.com/contest/2081/submission/320484694
https://www.luogu.com.cn/paste/23k58exp

附：状态机 DP 写法
https://codeforces.com/contest/2081/submission/320454305
